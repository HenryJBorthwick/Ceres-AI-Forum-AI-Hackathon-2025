# IPC Data Visualization Tool

A web-based tool for visualizing IPC (Integrated Food Security Phase Classification) data with historical trends and AI-powered predictions.

## Features

- Interactive dropdowns for country, level, and area selection
- Line charts showing IPC phases over time
- Historical data visualization (up to 2024)
- **AI-powered predictions for 2025 using satellite embeddings**
- Responsive design with Tailwind CSS

## Setup

### Prerequisites

- Python 3.8+
- Node.js 16+
- npm or yarn

### Backend (api/)

1. Navigate to the api directory:
   ```bash
   cd api
   ```

2. Create a virtual environment:
   ```bash
   python -m venv venv
   ```

3. Activate the virtual environment:
   - **Unix/macOS**: `source venv/bin/activate`
   - **Windows**: `venv\Scripts\activate`

4. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

5. **Install OpenMP library (required for AI predictions):**
   
   **macOS:**
   ```bash
   brew install libomp
   export DYLD_LIBRARY_PATH="$(brew --prefix libomp)/lib:$DYLD_LIBRARY_PATH"
   export OMP="$(brew --prefix libomp)"
   ```
   
   **Linux (Ubuntu/Debian):**
   ```bash
   sudo apt-get update
   sudo apt-get install libomp-dev
   ```
   
   **Linux (Fedora):**
   ```bash
   sudo dnf install libomp-devel
   ```

6. Start the backend server:
   ```bash
   uvicorn app:app --reload
   ```
   
   The backend will run on http://localhost:8000

   **Note:** If you see "Warning: Could not load ML model" in the logs, the AI predictions won't work. Ensure libomp is properly installed and environment variables are set.

### Frontend (frontend/)

1. Navigate to the frontend directory:
   ```bash
   cd frontend
   ```

2. Install dependencies:
   ```bash
   npm install
   ```

3. Start the development server:
   ```bash
   npm start
   ```
   
   The frontend will run on http://localhost:3000

## Data Requirements

Place your CSV file in the `data/` directory with the filename `ipc_global_area_long_current_only.csv`.

The CSV should contain columns:
- Country
- Level 1
- Area
- From (date)
- Phase
- Number
- Percentage
- Total country population

## API Endpoints

- `GET /countries` - List all available countries
- `GET /levels/{country}` - Get administrative levels for a country
- `GET /areas/{country}/{level1}` - Get areas for a country and level
- `GET /graph-data?country=...&level1=...&area=...` - Get aggregated data for visualization

## Usage

1. Open http://localhost:3000 in your browser
2. Select a country from the dropdown
3. Optionally select a level and area for more specific data
4. Click "Load Graph" to display the visualization
5. The chart shows IPC phases over time with dashed lines for predicted data

## Notes

- Tailwind CSS is used via CDN for quick styling in the MVP
- Predicted data is generated by varying the last historic year's crisis phases
- If fewer than 5 historic years exist, dummy data is generated
- CORS is enabled for local development
- Colors represent IPC phases: Phase 1 (green), 2 (yellow), 3 (orange), 4 (red), 5 (dark red)

## Troubleshooting

- Ensure both backend and frontend are running
- Check that the CSV file is in the correct location
- Verify the CSV format matches the expected columns
- Check browser console for any JavaScript errors
- Check backend logs for Python errors
